#!/usr/bin/env python

# Prints SSIDs probed by all Clients

import sys
import logging
logging.getLogger("scapy.runtime").setLevel(logging.ERROR)
from scapy.all import *

PROBE_REQ_TYPE = 0
PROBE_REQ_SUBTYPE = 4


def PacketHandler(pkt) :
        # Check if WiFi Packet
        if pkt.haslayer(Dot11):
                # Check if Probe Request
                if pkt.type == PROBE_REQ_TYPE and pkt.subtype == PROBE_REQ_SUBTYPE :
                        # Null probe removal
                        if pkt.info:
                                # Print Client MAC and probed SSID
                                print "Probe Request - Client: %s  SSID: %s" % (pkt.addr2, pkt.info)


# Command arguments: <wlan_interface>  <number_of_packets>

# Sniff <number_of_packets> on <wlan_interface>
sniff(iface=sys.argv[1], count=int(sys.argv[2]), prn=PacketHandler)