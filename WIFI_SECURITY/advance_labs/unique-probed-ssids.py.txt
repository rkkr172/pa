#!/usr/bin/env python
import sys
import logging
logging.getLogger("scapy.runtime").setLevel(logging.ERROR)
from scapy.all import *

PROBE_REQ_TYPE = 0
PROBE_REQ_SUBTYPE = 4

# List to store SSIDs
unique_ssids = []

def PacketHandler(pkt) :
        # Check if WiFi packet
        if pkt.haslayer(Dot11):
                # Check if Probe Request frame
                if pkt.type == PROBE_REQ_TYPE and pkt.subtype == PROBE_REQ_SUBTYPE :
                        # Null probe removal
                        if pkt.info not in unique_ssids:
                                # Add SSID to list
                                unique_ssids.append(pkt.info)
                                print "New probed SSID: %s" % ( pkt.info)


# Command Arguments: <interface_name> <number_of_packets>

# Sniffing on <interface_name> for <number_of_packets> packets
sniff(iface=sys.argv[1], count=int(sys.argv[2]), prn=PacketHandler)