#!/usr/bin/env python

import sys
import logging
logging.getLogger("scapy.runtime").setLevel(logging.ERROR)
from scapy.all import *

# List to store BSSIDs
ap_list = []

def PacketHandler(pkt) :
        # Check if it is a WiFi packet
        if pkt.haslayer(Dot11) :
                # If packet is a Beacon packet (Type=0 and SUbType=8)
                if pkt.type == 0 and pkt.subtype == 8 :
                        # Checking if BSSID NOT already present in  list
                        if pkt.addr2 not in ap_list :
                                # Adding BSSID to list
                                ap_list.append(pkt.addr2)
                                # If SSID field is non-empty
                                if len(pkt.info) > 1 :
                                        # Print SSID and BSSID
                                        print "Beacon Frame - BSSID: %s SSID: %s " % (pkt.addr2, pkt.info)


# Coomand Argument: pcap_name

# Opening PCAP for reading
pkts = rdpcap(sys.argv[1])

# Iterating over packets
for pkt in pkts :
        PacketHandler(pkt)